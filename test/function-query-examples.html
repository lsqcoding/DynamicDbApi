<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>动态查询函数调用示例</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .section {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h3 {
            color: #34495e;
        }
        .example {
            background-color: #f8f9fa;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
            border-left: 4px solid #3498db;
        }
        .json {
            font-family: 'Courier New', monospace;
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .description {
            margin-bottom: 10px;
            color: #555;
        }
        .response {
            background-color: #e8f4f8;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }
        .operator-table {
            border-collapse: collapse;
            width: 100%;
            margin: 10px 0;
        }
        .operator-table th, .operator-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .operator-table th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>动态查询函数调用示例</h1>
    
    <div class="section">
        <h2>1. 简单查询</h2>
        <p>基本的查询操作，用于获取表中的数据</p>
        
        <div class="example">
            <h3>查询所有列</h3>
            <div class="description">查询用户表中的所有列</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": ["*"]
}
            </div>
        </div>
        
        <div class="example">
            <h3>查询指定列</h3>
            <div class="description">查询用户表中的id、姓名和邮箱列</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": ["id", "name", "email"]
}
            </div>
        </div>
        
        <div class="example">
            <h3>带条件查询</h3>
            <div class="description">查询年龄大于等于18的用户</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": ["id", "name", "age"],
  "where": {
    "age__ge": 18
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>带排序查询</h3>
            <div class="description">查询用户表，按年龄降序排序</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": ["id", "name", "age"],
  "orderBy": {
    "age": "desc"
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>分页查询</h3>
            <div class="description">查询用户表，获取第2页，每页10条数据</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": ["id", "name", "email"],
  "page": {
    "pageIndex": 2,
    "pageSize": 10
  }
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>2. 复杂查询与条件操作符</h2>
        <p>支持丰富的条件操作符和复杂查询逻辑</p>
        
        <h3>支持的条件操作符</h3>
        <table class="operator-table">
            <tr>
                <th>操作符</th>
                <th>描述</th>
                <th>示例</th>
            </tr>
            <tr>
                <td>eq</td>
                <td>等于</td>
                <td>{"Name__eq": "John"}</td>
            </tr>
            <tr>
                <td>neq</td>
                <td>不等于</td>
                <td>{"Status__neq": "Inactive"}</td>
            </tr>
            <tr>
                <td>gt</td>
                <td>大于</td>
                <td>{"Age__gt": 18}</td>
            </tr>
            <tr>
                <td>ge</td>
                <td>大于等于</td>
                <td>{"Price__ge": 100}</td>
            </tr>
            <tr>
                <td>lt</td>
                <td>小于</td>
                <td>{"Score__lt": 60}</td>
            </tr>
            <tr>
                <td>le</td>
                <td>小于等于</td>
                <td>{"Quantity__le": 10}</td>
            </tr>
            <tr>
                <td>contains</td>
                <td>包含字符串</td>
                <td>{"Description__contains": "test"}</td>
            </tr>
            <tr>
                <td>startswith</td>
                <td>以字符串开头</td>
                <td>{"Name__startswith": "A"}</td>
            </tr>
            <tr>
                <td>endswith</td>
                <td>以字符串结尾</td>
                <td>{"Email__endswith": "@gmail.com"}</td>
            </tr>
            <tr>
                <td>in</td>
                <td>在集合中</td>
                <td>{"Id__in": [1, 2, 3]}</td>
            </tr>
            <tr>
                <td>notin</td>
                <td>不在集合中</td>
                <td>{"Category__notin": ["Spam", "Junk"]}</td>
            </tr>
            <tr>
                <td>isnull</td>
                <td>为空</td>
                <td>{"DeletedAt__isnull": true}</td>
            </tr>
            <tr>
                <td>notnull</td>
                <td>不为空</td>
                <td>{"Email__notnull": true}</td>
            </tr>
        </table>
        
        <div class="example">
            <h3>多条件组合查询</h3>
            <div class="description">查询年龄在18-30岁之间，且状态为active的用户</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": ["id", "name", "age", "status"],
  "where": {
    "age__ge": 18,
    "age__le": 30,
    "status__eq": "active"
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>IN条件查询</h3>
            <div class="description">查询id在1,3,5,7,9中的用户</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": ["id", "name"],
  "where": {
    "id__in": [1, 3, 5, 7, 9]
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>LIKE模糊查询</h3>
            <div class="description">查询姓名以'张'开头的用户</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": ["id", "name", "email"],
  "where": {
    "name__startswith": "张"
  }
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>3. 关联查询</h2>
        <p>支持多表关联查询，包括两表关联和三表关联</p>
        
        <div class="example">
            <h3>两表关联查询（使用表别名）</h3>
            <div class="description">查询订单及其用户信息，使用自定义表别名简化代码</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "orders",
  "operation": "select",
  "columns": [
    "orders.id as order_id",
    "orders.order_date",
    "orders.amount",
    "u.name as user_name",
    "u.email"
  ],
  "joins": [
    {
      "table": "users",
      "alias": "u",
      "type": "inner",
      "on": {
        "orders.user_id": "u.id"
      },
      "columns": ["u.name", "u.email"]
    }
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>三表关联查询（使用表别名）</h3>
            <div class="description">查询订单详情，包括订单信息和产品信息，使用自定义表别名</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "order_details",
  "operation": "select",
  "columns": [
    "order_details.id",
    "o.order_date",
    "p.product_name",
    "order_details.quantity",
    "order_details.price"
  ],
  "joins": [
    {
      "table": "orders",
      "alias": "o",
      "type": "inner",
      "on": {
        "order_details.order_id": "o.id"
      },
      "columns": ["o.order_date"]
    },
    {
      "table": "products",
      "alias": "p",
      "type": "inner",
      "on": {
        "order_details.product_id": "p.id"
      },
      "columns": ["p.product_name"]
    }
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>关联查询带分页（使用表别名）</h3>
            <div class="description">查询订单及其用户信息，带分页功能，使用自定义表别名</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "orders",
  "operation": "select",
  "columns": [
    "orders.id as order_id",
    "orders.order_date",
    "orders.amount",
    "u.name as user_name"
  ],
  "joins": [
    {
      "table": "users",
      "alias": "u",
      "type": "inner",
      "on": {
        "orders.user_id": "u.id"
      },
      "columns": ["u.name"]
    }
  ],
  "page": {
    "index": 1,
    "size": 10
  }
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>4. 聚合函数</h2>
        <p>支持 COUNT, SUM, AVG, MAX, MIN 等聚合函数</p>
        
        <div class="example">
            <h3>COUNT 函数 - 统计记录总数</h3>
            <div class="description">统计用户表中的用户总数</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": ["COUNT(*) as total_users"]
}
            </div>
        </div>
        
        <div class="example">
            <h3>SUM 函数 - 计算总和</h3>
            <div class="description">计算订单表中的总金额</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "orders",
  "operation": "select",
  "columns": ["SUM(amount) as total_amount"]
}
            </div>
        </div>
        
        <div class="example">
            <h3>AVG 函数 - 计算平均值</h3>
            <div class="description">计算产品表中的平均价格</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "products",
  "operation": "select",
  "columns": ["AVG(price) as avg_price"]
}
            </div>
        </div>
        
        <div class="example">
            <h3>MAX/MIN 函数 - 最大值和最小值</h3>
            <div class="description">获取订单表中的最大和最小金额</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "orders",
  "operation": "select",
  "columns": [
    "MAX(amount) as max_amount",
    "MIN(amount) as min_amount"
  ]
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>5. 分组查询</h2>
        <p>支持分组查询和聚合函数</p>
        
        <div class="example">
            <h3>简单分组查询</h3>
            <div class="description">按部门分组，统计每个部门的人数</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "department",
    "COUNT(*) as user_count"
  ],
  "groupBy": ["department"]
}
            </div>
        </div>
        
        <div class="example">
            <h3>分组带HAVING过滤</h3>
            <div class="description">按部门分组，只显示人数大于5的部门</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "department",
    "COUNT(*) as user_count"
  ],
  "groupBy": ["department"],
  "havingCondition": "user_count > 5"
}
            </div>
        </div>
        
        <div class="example">
            <h3>多列分组</h3>
            <div class="description">按部门和状态分组，统计人数</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "department",
    "status",
    "COUNT(*) as user_count",
    "AVG(age) as avg_age"
  ],
  "groupBy": ["department", "status"]
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>6. 字符串函数</h2>
        <p>支持 CONCAT, SUBSTR, UPPER, LOWER 等字符串函数</p>
        
        <div class="example">
            <h3>CONCAT 函数 - 拼接字符串</h3>
            <div class="description">拼接用户名和邮箱</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "name",
    "email",
    "CONCAT(name, ' (', email, ')') as user_info"
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>SUBSTR 函数 - 截取字符串</h3>
            <div class="description">截取用户名的前3个字符</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "name",
    "SUBSTR(name, 1, 3) as name_prefix"
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>UPPER/LOWER 函数 - 大小写转换</h3>
            <div class="description">将用户名转换为大写和小写</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "name",
    "UPPER(name) as name_upper",
    "LOWER(name) as name_lower"
  ]
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>7. 日期函数</h2>
        <p>支持 DATE, DATETIME, STRFTIME 等日期函数</p>
        
        <div class="example">
            <h3>DATE 函数 - 获取日期部分</h3>
            <div class="description">获取订单日期的日期部分</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "orders",
  "operation": "select",
  "columns": [
    "order_date",
    "DATE(order_date) as order_day"
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>DATETIME 函数 - 获取日期时间</h3>
            <div class="description">格式化订单日期时间</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "orders",
  "operation": "select",
  "columns": [
    "order_date",
    "DATETIME(order_date, 'localtime') as local_order_time"
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>STRFTIME 函数 - 格式化日期</h3>
            <div class="description">将日期格式化为指定格式</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "orders",
  "operation": "select",
  "columns": [
    "order_date",
    "STRFTIME('%Y-%m-%d', order_date) as formatted_date",
    "STRFTIME('%H:%M:%S', order_date) as formatted_time"
  ]
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>8. 数学函数</h2>
        <p>支持 ABS, ROUND, RANDOM 等数学函数</p>
        
        <div class="example">
            <h3>ABS 函数 - 绝对值</h3>
            <div class="description">计算数值的绝对值</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "products",
  "operation": "select",
  "columns": [
    "price_change",
    "ABS(price_change) as abs_change"
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>ROUND 函数 - 四舍五入</h3>
            <div class="description">将价格四舍五入到两位小数</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "products",
  "operation": "select",
  "columns": [
    "price",
    "ROUND(price, 2) as rounded_price"
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>RANDOM 函数 - 随机数</h3>
            <div class="description">生成随机数</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "id",
    "name",
    "RANDOM() as random_num"
  ],
  "orderBy": {
    "random_num": "asc"
  },
  "page": {
    "pageIndex": 1,
    "pageSize": 10
  }
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>9. 列计算与CASE WHEN</h2>
        <p>支持对列进行数学运算和条件表达式</p>
        
        <div class="example">
            <h3>价格 * 数量计算</h3>
            <div class="description">计算订单的总金额（价格 * 数量）</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "order_details",
  "operation": "select",
  "columns": [
    "product_id",
    "price",
    "quantity",
    "price * quantity as total_amount"
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>多列计算</h3>
            <div class="description">计算折扣后的价格</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "products",
  "operation": "select",
  "columns": [
    "product_name",
    "original_price",
    "discount_rate",
    "original_price * discount_rate as discounted_price"
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>简单 CASE WHEN</h3>
            <div class="description">根据用户年龄分组</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "name",
    "age",
    "CASE 
      WHEN age < 18 THEN '未成年'
      WHEN age BETWEEN 18 AND 30 THEN '青年'
      WHEN age BETWEEN 31 AND 50 THEN '中年'
      ELSE '老年'
    END as age_group"
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>CASE WHEN 与聚合函数结合</h3>
            <div class="description">统计不同状态的订单数量</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "orders",
  "operation": "select",
  "columns": [
    "COUNT(CASE WHEN status = 'pending' THEN 1 END) as pending_orders",
    "COUNT(CASE WHEN status = 'completed' THEN 1 END) as completed_orders",
    "COUNT(CASE WHEN status = 'cancelled' THEN 1 END) as cancelled_orders"
  ]
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>10. 通用表表达式 (CTE)</h2>
        <p>支持使用 WITH 子句创建临时结果集，简化复杂查询</p>
        
        <div class="example">
            <h3>基本CTE查询</h3>
            <div class="description">使用CTE查询用户订单统计信息</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "cte": {
    "name": "user_order_stats",
    "query": {
      "table": "orders",
      "columns": [
        "user_id",
        "COUNT(*) as order_count",
        "SUM(amount) as total_spent"
      ],
      "groupBy": ["user_id"]
    }
  },
  "columns": [
    "users.id",
    "users.name",
    "users.email",
    "uos.order_count",
    "uos.total_spent"
  ],
  "joins": [
    {
      "table": "user_order_stats",
      "alias": "uos",
      "type": "left",
      "on": {
        "users.id": "uos.user_id"
      },
      "columns": ["order_count", "total_spent"]
    }
  ],
  "orderBy": {
    "total_spent": "desc"
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>递归CTE查询</h3>
            <div class="description">使用递归CTE查询部门层级结构</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "departments",
  "operation": "select",
  "cte": {
    "name": "department_hierarchy",
    "query": {
      "table": "departments",
      "columns": [
        "id",
        "name",
        "parent_id",
        "1 as level"
      ],
      "where": {
        "parent_id__isnull": true
      }
    },
    "recursive": true,
    "union": {
      "table": "departments",
      "columns": [
        "departments.id",
        "departments.name",
        "departments.parent_id",
        "department_hierarchy.level + 1"
      ],
      "joins": [
        {
          "table": "department_hierarchy",
          "type": "inner",
          "on": {
            "departments.parent_id": "department_hierarchy.id"
          },
          "columns": ["level"]
        }
      ]
    }
  },
  "columns": [
    "department_hierarchy.id",
    "department_hierarchy.name",
    "department_hierarchy.parent_id",
    "department_hierarchy.level"
  ],
  "orderBy": {
    "level": "asc",
    "id": "asc"
  }
}
            </div>
        </div>
    </div>

    <div class="section">
        <h2>11. 数据操作-插入</h2>
        <p>支持插入单条和多条数据</p>
        
        <div class="example">
            <h3>插入单条数据</h3>
            <div class="description">向用户表插入一条新用户数据</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "insert",
  "data": {
    "name": "张三",
    "email": "zhangsan@example.com",
    "age": 25,
    "status": "active",
    "created_at": "2023-12-21T10:30:00"
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>插入多条数据</h3>
            <div class="description">向用户表插入多条用户数据</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "insert",
  "data": [
    {
      "name": "李四",
      "email": "lisi@example.com",
      "age": 30,
      "status": "active"
    },
    {
      "name": "王五",
      "email": "wangwu@example.com",
      "age": 28,
      "status": "inactive"
    }
  ]
}
            </div>
        </div>
        
        <div class="example">
            <h3>插入带自定义返回值</h3>
            <div class="description">插入数据并返回生成的ID</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "insert",
  "data": {
    "name": "赵六",
    "email": "zhaoliu@example.com",
    "age": 35
  },
  "returnQuery": {
    "columns": ["Id"],
    "where": {"Id": "__eq:3"}
  }
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>12. 数据操作 - 更新</h2>
        <p>支持更新数据，可带条件过滤</p>
        
        <div class="example">
            <h3>更新单条数据</h3>
            <div class="description">更新指定ID的用户信息</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "update",
  "data": {
    "name": "张三更新",
    "age": 26,
    "status": "active"
  },
  "where": {
    "id__eq": 1
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>更新多条数据</h3>
            <div class="description">更新所有状态为inactive的用户为active</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "update",
  "data": {
    "status": "active",
    "updated_at": "2023-12-21T10:30:00"
  },
  "where": {
    "status__eq": "inactive"
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>更新带自定义返回值</h3>
            <div class="description">更新数据并返回受影响的行数</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "update",
  "data": {
    "last_login": "2023-12-21T10:30:00"
  },
  "where": {
    "id__in": [1, 2, 3]
  },
  "returnQuery": {
    "columns": ["affected_rows"]
  }
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>13. 数据操作 - 删除</h2>
        <p>支持删除数据，可带条件过滤</p>
        
        <div class="example">
            <h3>删除单条数据</h3>
            <div class="description">删除指定ID的用户</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "delete",
  "where": {
    "id__eq": 1
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>删除多条数据</h3>
            <div class="description">删除所有年龄小于18的用户</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "delete",
  "where": {
    "age__lt": 18
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>删除带自定义返回值</h3>
            <div class="description">删除数据并返回受影响的行数</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "delete",
  "where": {
    "status__eq": "inactive",
    "created_at__lt": "2023-01-01T00:00:00"
  },
  "returnQuery": {
    "columns": ["affected_rows"]
  }
}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>14. 复杂组合示例</h2>
        <p>结合多种功能的复杂查询示例</p>
        
        <div class="example">
            <h3>聚合 + 分组 + HAVING + 排序</h3>
            <div class="description">按部门分组，统计部门人数和平均年龄，只显示人数大于10的部门，并按人数降序排序</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "department",
    "COUNT(*) as department_count",
    "AVG(age) as avg_age",
    "MAX(age) as max_age",
    "MIN(age) as min_age"
  ],
  "where": {
    "status__eq": "active"
  },
  "groupBy": ["department"],
  "havingCondition": "COUNT(*) > 10",
  "orderBy": {
    "department_count": "desc"
  },
  "page": {
    "pageIndex": 1,
    "pageSize": 5
  }
}
            </div>
        </div>
        
        <div class="example">
            <h3>关联 + 聚合 + 计算</h3>
            <div class="description">查询每个用户的订单总额和订单数</div>
            <div class="json">
{
  "dbId": "db1",
  "table": "users",
  "operation": "select",
  "columns": [
    "users.id as user_id",
    "users.name as user_name",
    "COUNT(orders.id) as order_count",
    "SUM(orders.amount) as total_spent",
    "AVG(orders.amount) as avg_order_amount"
  ],
  "joins": [
    {
      "table": "orders",
      "type": "left",
      "on": {
        "users.id": "orders.user_id"
      },
      "columns": ["orders.id", "orders.amount"]
    }
  ],
  "where": {
    "users.status__eq": "active"
  },
  "groupBy": ["users.id", "users.name"],
  "orderBy": {
    "total_spent": "desc"
  },
  "page": {
    "pageIndex": 1,
    "pageSize": 10
  }
}
            </div>
        </div>
    </div>
</body>
</html>